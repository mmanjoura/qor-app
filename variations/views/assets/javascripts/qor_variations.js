"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"===("undefined"==typeof exports?"undefined":_typeof(exports))?require("jquery"):jQuery)}(function(t){function e(t,e){var i="string"==typeof t?document.getElementById(t):t,a=i.cloneNode(!1);return a.innerHTML=e,i.parentNode.replaceChild(a,i),a}function i(e,a){this.$element=t(e),this.options=t.extend({},i.DEFAULTS,t.isPlainObject(a)&&a),this.init()}var a=window._,n=t(document),r="qor.variations",o="qor.replicator",s="enableVariations."+r,d="disable."+r,l="click."+r,c="keyup."+r,h="changed.medialibrary",f="addedMultiple."+o,u="addedMultipleDone."+o,p=".qor-product__property",m=p+' select[data-toggle="qor.chooser"]',v=p+"-selector",b=".qor-product__table tbody",_=".qor-product__table table",g=".qor-product__table tbody tr",y=".qor-product__container",q=".qor-fieldset",k=".qor-fieldset__add",V="qor_variants_id_",D="should_remove",$="is_removed",T=".is_deleted",C="tr.is-selected:not("+T+")",I="is_current",M=".qor-fieldset--init",x=".qor-fieldset:not(.qor-fieldset--new,.qor-product-init)",w=".qor-field__mediabox-data",E=".qor-product__button-save",j=".qor-product__bulk-save",B=".qor-product__filter-options",O='input[name*="QorResource.Variations"]:visible',R='input[name*="QorResource.Variations"][type!="hidden"]';return i.prototype={constructor:i,init:function(){var e=this.$element,i=e.data("input-name");i&&"QorResource.Variations"!=i&&(O='input[name*="'+i+'"]:visible',R='input[name*="'+i+'"][type!="hidden"]'),this.bind(),this.variants={},this.PrimaryInitMetaData={},this.productMetas=[],this.templateData=[],this.primaryMeta=[],this.existVariantsID=[],this.primaryMetaValue=[],this.replicatorTemplate=[],this.$tbody=e.find(b),this.$replicatorBtn=e.find(k),this.$fieldBlock=e.find(".qor-product__container>.qor-field__block"),this.hasPrimaryMeta=e.find(p).data("has-primary-meta"),this.BottomSheets=t("body").data("qor.bottomsheets"),this.initMetas(),this.initPrimaryMeta()},bind:function(){n.on(f,this.addVariantReplicator.bind(this)).on(u,this.addVariantReplicators.bind(this)),this.$element.on("select2:select select2:unselect",m,this.selectVariants.bind(this)).on(l,".qor-product__action--edit",this.editVariant.bind(this)).on(l,".qor-product__action--delete",this.deleteVariant.bind(this)).on(l,".qor-product__filter a",this.filterVariant.bind(this)).on(l,".qor-product__filter-actions__edit",this.bulkEditVariants.bind(this)).on(l,".qor-product__filter-actions__delete",this.bulkDeleteVariants.bind(this)).on(l,".qor-product__action--add",this.addBackDeletedVariants.bind(this)).on(l,".qor-product__fullscreen",this.fullscreen.bind(this)).on(l,"label.mdl-checkbox input:checkbox",this.showBulkEditVariantToolbar.bind(this))},unbind:function(){n.off(f,this.addVariantReplicator.bind(this)).off(u,this.addVariantReplicators.bind(this)),this.$element.off("select2:select select2:unselect",m,this.selectVariants.bind(this)).off(l,".qor-product__action--edit",this.editVariant.bind(this)).off(l,".qor-product__action--delete",this.deleteVariant.bind(this)).off(l,".qor-product__filter a",this.filterVariant.bind(this)).off(l,".qor-product__filter-actions__edit",this.bulkEditVariants.bind(this)).off(l,".qor-product__filter-actions__delete",this.bulkDeleteVariants.bind(this)).off(l,".qor-product__action--add",this.addBackDeletedVariants.bind(this)).off(l,".qor-product__fullscreen",this.fullscreen.bind(this)).off(l,"label.mdl-checkbox input:checkbox",this.showBulkEditVariantToolbar.bind(this))},initMetas:function(){for(var e=this.$element.find(".qor-product__meta"),i=0,a=e.length;a>i;i++)this.productMetas.push(t(e[i]).data("inputName"));this.setTemplate()},fullscreen:function(){this.$element.toggleClass("fullscreen").find(".qor-product__fullscreen i").toggle(),t(".qor-slideout").toggleClass("overflow-hidden")},collectExistVariantsID:function(){for(var e=this.$tbody.find("tr:not(."+$+")"),i=0,a=e.length;a>i;i++)this.existVariantsID.push(t(e[i]).attr("variants-id"))},initPrimaryMeta:function(){for(var e=this.$element.find(v),i=this.$element.find(M),a={},n=[],r=void 0,o=0,s=e.length;s>o;o++){var d=[],l=t(e[o]).attr("data-filter-meta",o).data("variant-type");if(this.primaryMeta.push(l),i.length){for(var c=0,h=i.length;h>c;c++){var f=t(i[c]),u=f.find("[name$="+l+"]").not('[type="hidden"]'),p=u.val(),m={},b={};if(u.is("select")&&p){var _=u.find('option[value="'+p+'"]').html();m[l]=_,m.id=p,r=this.checkSameObj(n,m),r||(d.push(m),this.primaryMetaValue.push({type:_,meta:l})),b[l+"_ID"]=m.id,b[l]=m[l],f.data("variants-"+l,b)}n.push(m)}d.length&&(a[l+"s"]=d)}}this.variants=this.PrimaryInitMetaData=a,this.variantsKey=this.collectObjectKeys(),this.handleTemplateData(),this.initPrimarySelector(),this.primaryMetaValue.length&&this.initFilter(),this.hasPrimaryMeta&&this.setCollectionID(i)},initPrimarySelector:function(){var e=this.PrimaryInitMetaData,i=Object.keys(e);this.ingoreInitChange=!0;for(var a=0,n=i.length;n>a;a++){for(var r=i[a].slice(0,-1),o=t('[data-variant-type="'+r+'"]').find(".qor-field__input-selector"),s=e[i[a]],d=0,l=s.length;l>d;d++){var c=o.find('option[value="'+s[d].id+'"]');c.length?c.prop("selected",!0):o.append("<option selected value='"+s[d].id+"'>"+s[d][r]+"</option>")}o.trigger("change")}this.ingoreInitChange=!1},initFilter:function(){var t=this.primaryMetaValue,e=this.$element.find(B);e.html("");for(var a=0,n=t.length;n>a;a++){var r=t[a];r.number=this.primaryMeta.indexOf(r.meta),e.append(window.Mustache.render(i.TEMPLATE_FILTER,r))}},toggleCheckbox:function(e,i){e.each(function(){i?t(this).addClass("is-checked").find(".mdl-checkbox__input").prop("checked",!0).closest("tr").addClass("is-selected"):t(this).removeClass("is-checked").find(".mdl-checkbox__input").prop("checked",!1).closest("tr").removeClass("is-selected")})},filterVariant:function(e){var i=t(e.target),a=i.data("filter-type"),n=this.$element.find(_),r=function(){var t=n.find(C);t.length&&(this.toggleCheckbox(t.find("label.mdl-checkbox")),this.toggleCheckbox(n.find("th label.mdl-checkbox")))}.bind(this);switch(a){case"all":n.find("th label.mdl-checkbox").trigger("click");break;case"none":r();break;default:r(),this.toggleCheckbox(this.$tbody.find('tr[variants-id*="_'+this.removeSpace(a)+'_"] label.mdl-checkbox'),!0)}n.find("label.mdl-checkbox").removeClass("is-focused"),this.showVariantToolbar()},showBulkEditVariantToolbar:function(){setTimeout(this.showVariantToolbar.bind(this),1)},showVariantToolbar:function(){var t=this.$tbody.find(C),e=this.$element.find(".qor-product__filter-actions"),i=t.length,a=this.$element.find(_).find("th label.mdl-checkbox");i?e.show().find("em").html(i):(e.hide(),a.hasClass("is-checked")&&this.toggleCheckbox(a))},bulkEditVariants:function(){var e=this.initBulkVariantsForm(),i=this.$tbody.find("tr:first"),a=this.$element.find(".qor-variants__edit"),n=i.find("td").length,r=t('<tr class="qor-variants__edit"><td class="normal" colspan='+n+"></td></tr>"),o='<button type="button" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored '+j.replace(".","")+'">\n                                OK\n                            </button>\n                            <button type="button" class="mdl-button mdl-js-button qor-product__bulk-cancel">\n                                Cancel\n                            </button><span class="qor-product__bulk-hint"></span>';return a.length?!1:(i.before(r),void e.appendTo(r.find("td")).show().append(o).trigger("enable").on(l,".qor-product-icon",this.checkBulkEdit.bind(this)).on(l,j,this.saveBulkEdit.bind(this)).on(l,".qor-product__bulk-cancel",this.removeBulkEdit.bind(this)))},checkBulkEdit:function(e){var i=t(e.target).closest(".qor-product-icon"),a=this.$element.find(".qor-variants__edit"),n=a.find(".qor-product__bulk-hint"),r=void 0;i.toggleClass("selected"),r=a.find(".qor-product-icon.selected").length,r?n.html(r+" items will be updated"):n.html("")},removeBulkEdit:function(){this.$element.find(".qor-variants__edit").remove()},saveBulkEdit:function(){var e=this.$element.find(".qor-product-icon.selected").parent(),i=this.$tbody.find(C),a=[],n=[];return e.length?i.length?(i.each(function(){n.push(t(this).attr("variants-id"))}),e.each(function(){var e=t(this).find(R+","+w),i={};e.length&&(e.is(w)&&(i.isImage=!0,i.isDeleted=t(w).data("isDeleted"),i.$element=t(this)),i.name=e.prop("name").match(/\.\w+$/g)[0].replace(".",""),i.value=e.is(":checkbox")?e.is(":checked"):e.val(),a.push(i))}),void this.syncBulkEditValue(a,n)):(window.alert("No variants select!"),!1):(this.$element.find(".qor-variants__edit").remove(),!1)},syncBulkEditValue:function(t,e){for(var i=this.$element,a=0,n=e.length;n>a;a++)for(var r='fieldset[fieldset-variants-id="'+e[a]+'"]',o=0,s=t.length;s>o;o++){var d=t[o],l=d.name,c=d.value,h=this.$tbody.find(C+' td[data-variant-type="'+l+'"]'),f=i.find(r+' [name$=".'+l+'"][type!="hidden"]');d.isImage?this.bulkAddImages(d,r):h.html(c),f.is(":checkbox")?(f.prop("checked",c),c?f.closest("label").addClass("is-checked"):f.closest("label").removeClass("is-checked")):f.val(c)}i.find(".qor-variants__edit").remove()},bulkAddImages:function(e,i){var a=e.$element;if(a){var n=this.$element.find(i),r=n.find(".qor-field__mediabox-list"),o=a.find(".qor-field__mediabox-item").not(".is_deleted"),s=this.$tbody.find(C+' td[data-variant-type="'+e.name+'"]'),d="";o.length?(r.find(".qor-field__mediabox-item").remove(),o.each(function(){var e=t(this),i=e.data("primary-key"),a=e.data("original-url");d=d+"<img data-primary-key='"+i+"' src='"+a+"'/>"}),s.html(d),o.appendTo(r)):(s.html(""),r.find(".qor-field__mediabox-item").remove())}},bulkDeleteVariants:function(e){var i=this.$tbody.find(C),a=this,n=t(e.target).data();return i.length&&n.confirm&&window.QOR.qorConfirm(n,function(e){if(e){for(var n=0,r=i.length;r>n;n++){var o=t(i[n]).attr("variants-id");a.hideRemovedVariants(o)}a.$element.find(".qor-product__filter-actions").hide(),a.showVariantToolbar()}}),!1},initBulkVariantsForm:function(){var t=this.primaryMeta,e=this.$element.find(".qor-fieldset--new").clone();t.push("Product");for(var i=0,a=t.length;a>i;i++)e.find("[name$="+t[i]+"]").not('[type="hidden"]').closest(".qor-form-section").remove();return e.find(".qor-form-section .qor-field").prepend('<span class="qor-product-icon"><i class="material-icons normal">panorama_fish_eye</i><i class="material-icons selected">check_circle</i></span>'),e.find(".qor-fieldset__delete").remove(),e.prepend("<h2>Bulk Edit</h2>"),e},addBackDeletedVariants:function(e){var i=t(e.target).closest("tr"),a=i.attr("variants-id");return a?void this.addBackVariants(a):!1},addBackVariants:function(t){var e=this.$tbody.find('tr[variants-id="'+t+'"]'),i=this.$element.find('fieldset[fieldset-variants-id="'+t+'"]'),n=e.hasClass("is_deleted"),r=void 0;e.length&&i.length&&(e.removeClass(D+" "+$+" is_deleted is-selected"),r=this.$tbody.find("tr:not("+T+"):last"),n&&(e.find("label").removeClass("is-disabled").show().find(".mdl-checkbox__input").prop("disabled",!1),e.find(".qor-product__action--add,.qor-product__action").toggle(),r.length?r.after(e):e.appendTo(this.$tbody),this.hiddenVariantsID=a.without(this.hiddenVariantsID,t)),i.removeClass(D+" "+$).find(".qor-fieldset__alert").remove())},setCollectionID:function(e){var i=this.primaryMeta,n=[];if(e.length){for(var r=0,o=e.length;o>r;r++){var s=t(e[r]),d={},l=void 0,c=void 0;if(s.attr("fieldset-variants-id"))return;for(var h=0,f=i.length;f>h;h++){var u=s.data("variants-"+i[h]);u&&(d=Object.assign({},d,u))}l=a.values(d).map(this.removeSpace).sort(),c=""+V+l.join("_")+"_",d.variantID=c,s.attr("fieldset-variants-id",c),n.push(d)}this.setTableID(n)}},setTableID:function(e){for(var i=this.primaryMeta,n=this.$element.find(g),r=void 0,o=0,s=n.length;s>o;o++){for(var d={},l=t(n[o]),c=0,h=i.length;h>c;c++){var f=i[c],u={},p=t.trim(l.find('[data-variant-type="'+f+'"]').data("variant-value"));p&&(u[f]=p,d=Object.assign({},d,u))}r=a.where(e,d),r.length&&l.attr("variants-id",r[0].variantID)}},removeSpace:function(t){return t.toString().replace(/\s/g,"")},checkSameObj:function(t,e){var i=void 0;return i=t.some(function(t){return a.isEqual(t,e)})},collectObjectKeys:function(t){var e=[],i=t||this.variants;return e=Object.keys(i).filter(function(t){return i[t].length>0})},setTemplate:function(){var t=this.productMetas,e="<tr variants-id=[[variantID]]>",i='<td>\n                                <button type="button" class="mdl-button mdl-js-button qor-product__action--add" style="display: none;">\n                                    Add\n                                </button>\n                                <button type="button" id="qor-product-actions-for-[[variantID]]" class="mdl-button mdl-js-button mdl-button--icon qor-product__action">\n                                    <i class="material-icons">more_vert</i>\n                                </button>\n                                <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu" for="qor-product-actions-for-[[variantID]]">\n                                    <li class="mdl-menu__item" qor-icon-name="Edit">\n                                        <a href="javascript://" class="qor-product__action--edit">Edit</a>\n                                    </li>\n                                    <li class="mdl-menu__item" qor-icon-name="Delete">\n                                        <a href="javascript://" class="qor-product__action--delete">Delete</a>\n                                    </li>\n                                </ul>\n                            </td></tr>';a.each(t,function(t){e=e+"<td data-variant-type="+t+' class="mdl-data-table__cell--non-numeric">[['+t+"]]</td>"}),this.template=""+e+i},deleteVariant:function(e){var i=t(e.target),a=i.closest("tr").attr("variants-id"),n=this,r=i.data();return r.confirm&&window.QOR.qorConfirm(r,function(t){t&&(n.hideRemovedVariants(a),n.showVariantToolbar())}),!1},editVariant:function(e){var i=t(e.target).closest("tr"),a=i.find("td").length,n=i.attr("variants-id"),r=void 0,o=t('<tr class="qor-variant__edit"><td class="normal" colspan='+a+"></td></tr>"),s='<button type="button" class="mdl-button mdl-js-button mdl-button--raised '+E.replace(".","")+'">OK</button>';return i.next("tr.qor-variant__edit").length?!1:n?(r=t('fieldset[fieldset-variants-id="'+n+'"]'),i.addClass(I).after(o),r.appendTo(o.find("td")).trigger("enable").find(E).remove().end().append(s).show().removeClass("hidden").on(c,O,this.syncCollectionToVariant.bind(this)).on(l,E,this.saveCollevtionEdit.bind(this)).on(h,w,this.syncCollectionToVariant.bind(this)),void this.hidePrimaryMeta(r)):!1},hidePrimaryMeta:function(t){for(var e=this.primaryMeta,i=0,a=e.length;a>i;i++)t.find("[name$="+e[i]+"]").not('[type="hidden"]').closest(".qor-form-section").hide()},syncCollectionToVariant:function(e){var i=t(e.target),a=i.val(),n=i.closest(q).attr("fieldset-variants-id"),r=t('tr[variants-id="'+n+'"]'),o=i.prop("name").match(/\.\w+$/g)[0].replace(".",""),s=void 0,d=void 0;if(s=r.find('[data-variant-type="'+o+'"]'),i.is("textarea"))if(d=JSON.parse(a),d.length){for(var l="",c=0,h=d.length;h>c;c++)l=l+'<img src="'+d[c].Url+'"/>';s.html(l)}else s.html("");else s.html(a)},saveCollevtionEdit:function(e){var i=t(e.target),a=i.closest(q),n=a.closest("tr");n.prev().removeClass(I).end().remove(),a.appendTo(this.$fieldBlock).off(c,O,this.syncCollectionToVariant.bind(this)).off(l,E,this.saveCollevtionEdit.bind(this)).off(h,w,this.syncCollectionToVariant.bind(this)).hide()},selectVariants:function(e){var i=t(e.target).closest(v),a=i.data("variant-type"),n=e.params.data,r=n.selected,o=n.text||n.title||n.Name,s=n.id,d=a+"s",l=!i.find(".select2-selection__choice").length;return this.ingoreInitChange?!1:(this.variants[d]=this.variants[d]||[],r?this.doSelelct(o,d,a,s):this.doUnselelct(o,d,a,s,l),this.replicatorTemplate=[],void this.initFilter())},doUnselelct:function(t,e,i,n,r){this.variants[e]=this.variants[e].filter(function(e){return e[i]!=t}),this.removeVariants(t,n,i),r?this.renderVariants():this.handleTemplateData(),this.primaryMetaValue=a.reject(this.primaryMetaValue,function(e){return a.isMatch(e,{type:t,meta:i})})},doSelelct:function(t,e,i,a){var n={};n[i]=t,n.id=a.toString(),this.variants[e].push(n),this.renderVariants(),this.primaryMetaValue.push({type:t,meta:i})},removeVariants:function(t,e,i){var n=this.templateData,r={};r[i]=t,r[i+"s_ID"]=e;for(var o=0,s=n.length;s>o;o++){var d=n[o];a.isMatch(d,r)&&this.hideRemovedVariants(d.variantID)}this.showVariantToolbar()},hideRemovedVariants:function(t){var e=this.$tbody.find('tr[variants-id="'+t+'"]'),i=this.$tbody.find(".qor-variant__edit"),a=this.$element.find('fieldset[fieldset-variants-id="'+t+'"]');e.length&&a.length&&!e.hasClass("is_deleted")&&(this.hiddenVariantsID=this.hiddenVariantsID||[],this.hiddenVariantsID.push(t),i.length&&(this.$element.find(".qor-fieldset--new").before(i.find(".qor-fieldset")),i.remove()),e.addClass($+" is_deleted").removeClass("is-selected").find(".qor-product__action--add,.qor-product__action").toggle(),e.find("label").removeClass("is-checked").addClass("is-disabled").hide().find(".mdl-checkbox__input").prop({checked:!1,disabled:!0}),e.appendTo(this.$tbody),a.addClass($).find(".qor-fieldset__alert").remove().end().find(".qor-fieldset__delete").trigger("click").hide())},renderVariants:function(){var t=void 0;return t=this.collectObjectKeys(),0===t.length?void this.$tbody.find("tr:not(.qor-product-init)").hide():(this.variantsKey=t,void this.convertVariantsData())},convertVariantsData:function(){this.handleTemplateData(),this.renderVariantsTable()},handleTemplateData:function(){var t=[],e=this.variantsKey,i=this.variants;if(this.templateData=[],a.each(e,function(e){t.push(i[e].length)}),1===e.length)for(var n=i[e[0]],r=0,o=n.length;o>r;r++){var s=n[r],d=a.keys(s)[0],l=s[d],c=void 0,h={};h[d]=l,h.id=s.id,c=a.values(h).map(this.removeSpace).sort(),h.variantID=""+V+c.join("_")+"_",this.templateData.push(h)}else this.handleMultipleVariantsData(t,this.generateData.bind(this))},renderVariantsTable:function(){var t=this.$element.find(_),e=void 0;t.removeClass("is-upgraded").removeAttr("data-upgraded").find("tr td:first-child,tr th:first-child").remove(),e=this.checkTemplateData().newObjs,t.trigger("enable").find(".is_deleted label.mdl-checkbox").hide(),this.$tbody.find("."+D).remove(),e.length&&setTimeout(function(){this.doReplicator(e)}.bind(this),500)},doReplicator:function(t){var e=this.$element;this.replicator=this.replicator||e.find(y).data(o),this.replicator.add(null,t,!0),this.$element.find("."+D+x+" .qor-fieldset__delete").trigger("click").hide()},checkTemplateData:function(){var t=this.templateData,e=this.hiddenVariantsID||[],i=[],n=[];this.collectExistVariantsID(),this.$element.find(x+","+g+":not(.qor-product-init)").addClass(D);for(var r=0,o=t.length;o>r;r++){var s=t[r],d=void 0,l=void 0,c=s.variantID;e.length&&(d=a.contains(e,c)),this.existVariantsID.length&&(l=a.contains(this.existVariantsID,c)),d||l?(n.push(s),this.addBackVariants(c)):(this.$tbody.prepend(window.Mustache.render(this.template,s)),i.push(s))}return{oldObjs:n,newObjs:i}},generateData:function(t){for(var e=this.variantsKey,i=this.variants,n=void 0,r={},o=0,s=t.length;s>o;o++){var d=i[e[o]][t[o]];r[e[o]+"_ID"]=d.id,r=Object.assign({},r,d)}delete r.id,n=a.values(r).map(this.removeSpace).sort(),r.variantID=""+V+n.join("_")+"_",this.templateData.push(r)},handleMultipleVariantsData:function(t,e){this.convertMultipleVariantsData(t,e,[],0)},convertMultipleVariantsData:function(t,e,i,a){if(0==t.length)e(i);else{var n=t.slice(1);for(i[a]=0;i[a]<t[0];++i[a])this.convertMultipleVariantsData(n,e,i,a+1)}},addVariantReplicator:function(t,e,i){e=this.syncReplicatorData(e,i),e.attr("fieldset-variants-id",i.variantID).hide(),this.replicatorTemplate.push(e.prop("outerHTML"))},addVariantReplicators:function(){var i=t("<div></div>"),a=this.$element.find(".qor-product__block"),n=this.replicatorTemplate.join("");i.appendTo(a),e(i[0],n)},syncReplicatorData:function(t,i){for(var a=Object.keys(i),n=0,r=a.length;r>n;n++){var o=t.find("[name$="+a[n]+"]").not('[type="hidden"]'),s=void 0,d=void 0;if(o.length&&o.is("select")){var l=o.find('option[value="'+i.id+'"]');l.length?o.val(i.id):(s=a[n]+"s_ID",d="<option selected value='"+(i.id||i[s])+"'>"+i[a[n]]+"</option>",e(o[0],d))}}return t},addLoading:function(){var e=t(i.TEMPLATE_LOADING);e.appendTo(this.$element.find(y)).trigger("enable")},destroy:function(){this.unbind(),this.$element.removeData(r)}},i.TEMPLATE_FILTER='<li><a href="javascript://" data-filter-type="[[type]]" data-filter-meta=[[number]]>[[type]]</a></li>',i.TEMPLATE_LOADING='<div class="qor-product__loading">\n            <div><div class="mdl-spinner mdl-js-spinner is-active qor-layout__bottomsheet-spinner"></div></div>\n        </div>',i.plugin=function(e){return this.each(function(){var a=t(this),n=a.data(r),o=void 0;if(!n){if(/destroy/.test(e))return;a.data(r,n=new i(this,e))}"string"==typeof e&&t.isFunction(o=n[e])&&o.apply(n)})},t(function(){var a='[data-toggle="qor.variations"]';n.on(d,function(e){i.plugin.call(t(a,e.target),"destroy")}).on(s,function(e){i.plugin.call(t(a,e.target))}).on("beforeEnable.qor.slideout",".qor-slideout",function(){i.fieldsetInits=t(a).find(".qor-fieldset--inits").html(),t(a).find(".qor-fieldset--inits").html("")}).on("afterEnable.qor.slideout",".qor-slideout",function(){e(t(a).find(".qor-fieldset--inits")[0],i.fieldsetInits),n.triggerHandler(s)}).triggerHandler(s)}),i});